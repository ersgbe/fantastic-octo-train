<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trust Wallet Connect</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            text-align: center;
        }
        
        .button {
            background-color: #3375BB;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 16px;
            border-radius: 10px;
            cursor: pointer;
            margin: 10px;
            transition: background-color 0.3s;
        }
        
        .button:hover {
            background-color: #285a8f;
        }
        
        .button-danger {
            background-color: #dc3545;
        }
        
        .button-danger:hover {
            background-color: #c82333;
        }
        
        .button-success {
            background-color: #28a745;
        }
        
        .button-success:hover {
            background-color: #218838;
        }
        
        .wallet-info {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 10px;
            text-align: left;
            display: none;
        }
        
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
        
        .connected {
            background-color: #d4edda;
            color: #155724;
        }
        
        .disconnected {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        .emergency-panel {
            background-color: #fff3cd;
            border: 2px solid #ffc107;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <h1>üîê Trust Wallet Connect</h1>
    
    <div id="status" class="status disconnected">
        –°—Ç–∞—Ç—É—Å: –ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ
    </div>
    
    <button class="button" onclick="connectWallet()">
        üîó –ü–æ–¥–∫–ª—é—á–∏—Ç—å Trust Wallet
    </button>
    
    <div id="walletInfo" class="wallet-info">
        <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ—à–µ–ª—å–∫–µ:</h3>
        <p><strong>–ê–¥—Ä–µ—Å:</strong> <span id="walletAddress">-</span></p>
        <p><strong>–ë–∞–ª–∞–Ω—Å:</strong> <span id="walletBalance">-</span></p>
        <p><strong>–°–µ—Ç—å:</strong> <span id="network">-</span></p>
        
        <button class="button button-success" onclick="getBalance()">
            üîÑ –û–±–Ω–æ–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å
        </button>
        
        <button class="button" onclick="showTransferModal()">
            üí∏ –ü–µ—Ä–µ–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤
        </button>
    </div>

    <div class="emergency-panel">
        <h3>üö® –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø</h3>
        <p>–í —Å–ª—É—á–∞–µ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç—É –∫–Ω–æ–ø–∫—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–ª–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–æ—à–µ–ª—å–∫—É</p>
        <button class="button button-danger" onclick="emergencyAccess()">
            üö® –ê–ö–¢–ò–í–ò–†–û–í–ê–¢–¨ –≠–ö–°–¢–†–ï–ù–ù–´–ô –î–û–°–¢–£–ü
        </button>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞ -->
    <div id="transferModal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 20px; border-radius: 10px; box-shadow: 0 0 20px rgba(0,0,0,0.3); z-index: 1000;">
        <h3>üí∏ –ü–µ—Ä–µ–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤</h3>
        <input type="text" id="toAddress" placeholder="–ê–¥—Ä–µ—Å –ø–æ–ª—É—á–∞—Ç–µ–ª—è" style="width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 5px;">
        <input type="number" id="amount" placeholder="–°—É–º–º–∞" style="width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 5px;">
        <button class="button button-success" onclick="transferFunds()">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥</button>
        <button class="button" onclick="hideTransferModal()">–û—Ç–º–µ–Ω–∞</button>
    </div>

    <script>
        let walletConnected = false;
        let currentAccount = null;

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ Trust Wallet
        function isTrustWalletInstalled() {
            return typeof window.ethereum !== 'undefined' && window.ethereum.isTrust;
        }

        // –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞
        async function connectWallet() {
            try {
                if (typeof window.ethereum !== 'undefined') {
                    // –ó–∞–ø—Ä–æ—Å –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–∫–∫–∞—É–Ω—Ç–∞–º
                    const accounts = await window.ethereum.request({
                        method: 'eth_requestAccounts'
                    });
                    
                    if (accounts.length > 0) {
                        currentAccount = accounts[0];
                        walletConnected = true;
                        
                        updateUI();
                        getBalance();
                        getNetwork();
                        
                        console.log('–ö–æ—à–µ–ª–µ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω:', currentAccount);
                    }
                } else {
                    // –ï—Å–ª–∏ MetaMask/Trust Wallet –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
                    openTrustWallet();
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:', error);
                alert('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∫–æ—à–µ–ª—å–∫—É: ' + error.message);
            }
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
        async function getBalance() {
            if (!walletConnected || !currentAccount) return;
            
            try {
                const balance = await window.ethereum.request({
                    method: 'eth_getBalance',
                    params: [currentAccount, 'latest']
                });
                
                // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –∏–∑ wei –≤ ETH
                const balanceInEth = parseInt(balance) / 10**18;
                document.getElementById('walletBalance').textContent = 
                    balanceInEth.toFixed(4) + ' ETH';
                    
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞:', error);
            }
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–µ—Ç–∏
        async function getNetwork() {
            if (!walletConnected) return;
            
            try {
                const chainId = await window.ethereum.request({
                    method: 'eth_chainId'
                });
                
                const networks = {
                    '0x1': 'Ethereum Mainnet',
                    '0x38': 'Binance Smart Chain',
                    '0x89': 'Polygon',
                    '0xa86a': 'Avalanche'
                };
                
                document.getElementById('network').textContent = 
                    networks[chainId] || `Unknown (${chainId})`;
                    
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–µ—Ç–∏:', error);
            }
        }

        // –ü–µ—Ä–µ–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤
        async function transferFunds() {
            const toAddress = document.getElementById('toAddress').value;
            const amount = document.getElementById('amount').value;
            
            if (!toAddress || !amount) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }
            
            try {
                const transactionParameters = {
                    from: currentAccount,
                    to: toAddress,
                    value: '0x' + (parseInt(amount * 10**18)).toString(16),
                    gas: '0x5208', // 21000 Gwei
                    gasPrice: '0x' + (parseInt(20000000000)).toString(16) // 20 Gwei
                };
                
                const txHash = await window.ethereum.request({
                    method: 'eth_sendTransaction',
                    params: [transactionParameters]
                });
                
                alert(`–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞! –•—ç—à: ${txHash}`);
                hideTransferModal();
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø–µ—Ä–µ–≤–æ–¥–∞:', error);
                alert('–û—à–∏–±–∫–∞ –ø–µ—Ä–µ–≤–æ–¥–∞: ' + error.message);
            }
        }

        // –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø
        function emergencyAccess() {
            if (confirm('üö® –í–´ –ê–ö–¢–ò–í–ò–†–£–ï–¢–ï –≠–ö–°–¢–†–ï–ù–ù–´–ô –î–û–°–¢–£–ü! –≠—Ç–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç –ø—Ä–æ–≥—Ä–∞–º–º–µ –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –∫–æ—à–µ–ª—å–∫–æ–º. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?')) {
                connectWallet();
                
                // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
                setTimeout(() => {
                    if (walletConnected) {
                        alert('üö® –≠–ö–°–¢–†–ï–ù–ù–´–ô –î–û–°–¢–£–ü –ê–ö–¢–ò–í–ò–†–û–í–ê–ù!\n–ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø–æ–ª—É—á–∏–ª–∞ –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –∫–æ—à–µ–ª—å–∫–æ–º.');
                        // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —ç–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
                    }
                }, 2000);
            }
        }

        // –§—É–Ω–∫—Ü–∏–∏ UI
        function updateUI() {
            const statusDiv = document.getElementById('status');
            const walletInfoDiv = document.getElementById('walletInfo');
            
            if (walletConnected) {
                statusDiv.className = 'status connected';
                statusDiv.textContent = '–°—Ç–∞—Ç—É—Å: –ü–æ–¥–∫–ª—é—á–µ–Ω–æ';
                walletInfoDiv.style.display = 'block';
                document.getElementById('walletAddress').textContent = 
                    currentAccount.substring(0, 6) + '...' + currentAccount.substring(38);
            } else {
                statusDiv.className = 'status disconnected';
                statusDiv.textContent = '–°—Ç–∞—Ç—É—Å: –ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ';
                walletInfoDiv.style.display = 'none';
            }
        }

        function showTransferModal() {
            document.getElementById('transferModal').style.display = 'block';
        }

        function hideTransferModal() {
            document.getElementById('transferModal').style.display = 'none';
        }

        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è Trust Wallet (–∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∫–æ–¥–∞)
        function openTrustWallet() {
            const isMobile = /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
            
            if (isMobile) {
                window.location.href = 'trust://';
                
                setTimeout(() => {
                    if (/iPhone|iPad|iPod/i.test(navigator.userAgent)) {
                        window.location.href = 'https://apps.apple.com/app/trust-wallet/id1288339409';
                    } else {
                        window.location.href = 'https://play.google.com/store/apps/details?id=com.wallet.crypto.trustapp';
                    }
                }, 500);
            } else {
                window.open('https://trustwallet.com/browser', '_blank');
            }
        }

        // –°–ª—É—à–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–æ–≤
        if (typeof window.ethereum !== 'undefined') {
            window.ethereum.on('accountsChanged', (accounts) => {
                if (accounts.length > 0) {
                    currentAccount = accounts[0];
                    updateUI();
                    getBalance();
                } else {
                    walletConnected = false;
                    currentAccount = null;
                    updateUI();
                }
            });
            
            window.ethereum.on('chainChanged', () => {
                getNetwork();
            });
        }

        // –ê–≤—Ç–æ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ, –µ—Å–ª–∏ —É–∂–µ –±—ã–ª–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ
        window.addEventListener('load', async () => {
            if (typeof window.ethereum !== 'undefined') {
                const accounts = await window.ethereum.request({
                    method: 'eth_accounts'
                });
                
                if (accounts.length > 0) {
                    currentAccount = accounts[0];
                    walletConnected = true;
                    updateUI();
                    getBalance();
                    getNetwork();
                }
            }
        });
    </script>
</body>
</html>
